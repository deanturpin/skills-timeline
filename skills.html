<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8"/>

<!-- Skills -->
<script type="text/javascript">

"use strict"

// Current year
const now = 2017

// Skills and date range
const skills = [

	["C++",			1996, now],
	["Embedded",	1998, now],
	["SC",			1998, now],
	["Vim",			1998, now],
	["VxWorks",		1998, 2009],
	["Unix",		1998, 2009],
	["Networking",	2003, now],
	["Regex",		2007, now],
	["Bash",		2009, now],
	["Linux	",		2009, now],
	["Subversion",	2012, now],
	["VMware",		2012, 2016],
	["STL",			2013, now],
	["C++11/14",	2015, now],
	["Agile",		2015, 2016],
	["Clang",		2015, now],
	["Iwyu",		2015, 2016],
	["JavaScript",	2016, now],
	["Git",			2015, now],
	["Lua",			2016, 2016],
	["Haskell",		2016, now],
]
</script>

<!-- Timeline generator -->
<script type="text/javascript">

	"use strict"

	// Don't do anything until page has loaded completely
	onload = function() {

		// Create a canvas element
		const canvas = document.createElement("canvas")
		const body = document.getElementsByTagName("body")[0]

		// Add it to the DOM
		body.appendChild(canvas)

		// Define canvas (view port)
		const context = canvas.getContext("2d")

		// Set canvas size
		canvas.width = window.innerWidth
		canvas.height = window.innerHeight

		// Create range variable and initialise to out of range
		function year() {

			this.min,
			this.max
		}

		// Initialise year range
		year.min = 3000
		year.max = 0

		// Parse to find min and max
		for (let i = 0; i < skills.length; ++i) {
		
			// Get min and max years
			if (skills[i][1] < year.min)
				year.min = skills[i][1]

			if (skills[i][2] > year.max)
				year.max = skills[i][2]
		}

		// Define scale function and initialise
		function scale() {

			this.x,
			this.y
		}

		scale.x = .75 * canvas.width / (year.max - year.min)
		scale.y = .9 * canvas.height / skills.length
		const padding = 10

		// Add year scale
		for (let s = 0; s <= year.max - year.min; ++s) {

			// Extract the lower two digits of the year
			const yr = "" + (year.min + s)
			context.fillText("\'" + yr.substring(2), s * scale.x, padding)
		}

		// Parse to print bars
		for (let i = 0; i < skills.length; ++i) {

			const skill = skills[i][0]
			const start = skills[i][1]
			const end = skills[i][2]
			const duration = 1 + skills[i][2] - skills[i][1]

			// Calculate end points
			const x1 = scale.x * (start - year.min)
			const x2 = x1 + duration*scale.x
			const y = 2*padding + i*scale.y

			// Render stroke
			context.beginPath()
			context.moveTo(x1, y)
			context.lineTo(x2, y)
			context.lineWidth = 3
			context.stroke()

			// Add skill
			context.fillText(skill,
				padding + (1 + year.max - year.min) * scale.x, y + padding/2)
		}

		// Periodically reload the page if there's a token in the URL
		setInterval(function() {

			if (window.location.href.split("?").pop() === "reload")
				window.location.reload()
		}, 2000)
	}
</script>
